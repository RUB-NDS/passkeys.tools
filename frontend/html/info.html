<div class="row mb-3">
    <div class="col my-3 bg-light rounded-3 text-center p-3">
        <img src="pkworkbench.svg" width="200px">
        <h1 class="small-caps">Passkeys.Tools</h1>
        <h2>Advanced tools that let you encode, decode, modify, and intercept<br>WebAuthn attestations and assertions directly within your browser.</h2>
    </div>
</div>

<div class="row mb-3">
    <div class="col">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Welcome to <span class="small-caps">Passkeys.Tools</span></h5>
            </div>
            <div class="card-body">
                <p><span class="small-caps">Passkeys.Tools</span> is a comprehensive suite of development and debugging tools for WebAuthn/Passkey implementations. These tools enable full emulation of clients (browsers) and authenticators to thoroughly test relying party implementations, security compliance, and edge cases.</p>

                <h6>Featured Tools:</h6>
                <ul>
                    <li><strong>Create:</strong> Simulates <code>navigator.credentials.create()</code> WebAuthn API calls to test credential registration flows.</li>
                    <li><strong>Get:</strong> Simulates <code>navigator.credentials.get()</code> for testing authentication flows.</li>
                    <li><strong>Attestation:</strong> Decode, modify, and encode attestation objects in various formats. Load custom keys or store keys in integrated storage.</li>
                    <li><strong>Assertion:</strong> Decode, modify, and encode assertions. Sign with arbitrary keys from storage or verify existing signatures.</li>
                    <li><strong>Keys:</strong> Integrated key storage with import/export capabilities. Convert between COSE, JWK, and other formats. Generate new keys with all standardized algorithms and manage credential IDs.</li>
                    <li><strong>Users:</strong> Manage user accounts across relying parties with RP IDs, usernames, display names, and user IDs. Automatically captures users from registrations.</li>
                    <li><strong>Converters:</strong> Simple utilities for converting between various encoding formats.</li>
                    <li><strong>Interceptor:</strong> Requires <a href="extension.zip">companion browser extension</a>. Intercepts all WebAuthn operations for modification (like Burp Suite for WebAuthn). Includes built-in security and compliance tests.</li>
                    <li><strong>History:</strong> Tracks all interceptions and modifications, enabling value swaps across different passkey operations and browsers (i.e., victim and attacker browsers).</li>
                </ul>

                <h6>Getting Started:</h6>
                <ol>
                    <li>For <strong>standalone testing</strong>: Use Create/Get tabs to simulate WebAuthn API calls and test your RP implementation.</li>
                    <li>For <strong>live debugging</strong>: Install the companion browser extension and use the Interceptor to modify real passkey flows.</li>
                    <li>Analyze and modify responses using the Attestation and Assertion tools.</li>
                    <li>Manage test credentials and users in the Keys and Users tabs for comprehensive testing scenarios.</li>
                    <li>Use History to track and replay modified operations across different test sessions.</li>
                </ol>

                <div class="mt-3">
                    <h6>Load Example Data:</h6>
                    <div class="input-group" style="max-width: 500px;">
                        <span class="input-group-text">Examples</span>
                        <select class="form-select" id="examplesSelect">
                            <option selected>Select an example...</option>
                        </select>
                        <button class="btn btn-primary" id="examplesLoadBtn">Load Example</button>
                    </div>
                    <small class="text-muted">Load pre-configured examples to explore different attestation and assertion objects</small>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mb-3">
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0">Client Capabilities</h5>
            </div>
            <div class="card-body">
                <div id="capabilities"></div>
            </div>
        </div>
    </div>
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0">Keyboard Shortcuts</h5>
            </div>
            <div class="card-body">
                <table class="table table-sm table-hover mb-0" id="shortcutsTable">
                    <thead>
                        <tr>
                            <th>Shortcut</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Dynamically populated -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="row mb-3">
    <div class="col">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Current Limitations</h5>
            </div>
            <div class="card-body">
                <ul class="mb-0">
                    <li>Only the <a href="https://www.w3.org/TR/webauthn-3/#sctn-none-attestation">None</a> and <a href="https://www.w3.org/TR/webauthn-3/#sctn-packed-attestation">Packed</a> attestation statement formats are supported.</li>
                    <li>In the <a href="https://www.w3.org/TR/webauthn-3/#sctn-packed-attestation">Packed</a> attestation statement format, the signature and certificates need to be added manually if required.</li>
                    <li><a href="https://www.w3.org/TR/webauthn-3/#sctn-extensions">Extensions</a> are not automatically parsed but need to be added manually if required.</li>
                    <li><a href="https://www.w3.org/TR/webauthn-3/#sctn-client-extension-processing">Client Extension Processing</a> and <a href="https://www.w3.org/TR/webauthn-3/#sctn-authenticator-extension-processing">Authenticator Extension Processing</a> is not supported.</li>
                    <li>To use the Ed25519 algorithm <a href="https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/importKey#browser_compatibility">in Chrome</a>, you need to enable the <a href="chrome://flags/#enable-experimental-web-platform-features">#enable-experimental-web-platform-features</a> flag.</li>
                </ul>
            </div>
        </div>
    </div>
</div>
