<div class="row mb-3">
    <div class="col m-3 p-3 text-center">
        <img src="logo.svg" width="200px">
        <h1 class="small-caps">Passkeys.Tools</h1>
        <h2>Encode, Decode, Intercept, Modify, and Exploit WebAuthn Operations</h2>
    </div>
</div>

<div class="row mb-3">
    <div class="col">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0">Overview</h5>
            </div>
            <div class="card-body">
                <p><span class="small-caps">Passkeys.Tools</span> is a comprehensive suite of development and debugging tools for WebAuthn/Passkey implementations. These tools enable full emulation of clients (browsers) and authenticators to thoroughly test relying party implementations, security compliance, and edge cases.</p>

                <h6>Featured Tools:</h6>
                <ul>
                    <li><strong>Create:</strong> Simulates <code>navigator.credentials.create()</code> WebAuthn API calls to test credential registration flows.</li>
                    <li><strong>Get:</strong> Simulates <code>navigator.credentials.get()</code> for testing authentication flows.</li>
                    <li><strong>Attestation:</strong> Decode, modify, and encode attestation objects in various formats (like <a href="https://www.jwt.io">jwt.io</a> for WebAuthn). Load custom keys or store keys in integrated storage.</li>
                    <li><strong>Assertion:</strong> Decode, modify, and encode assertions. Sign with arbitrary keys from storage or verify existing signatures.</li>
                    <li><strong>Keys:</strong> Integrated key storage with import/export capabilities. Convert between COSE, JWK, and other formats. Generate new keys with all standardized algorithms and manage credential IDs.</li>
                    <li><strong>Users:</strong> Manage user accounts across relying parties with RP IDs, usernames, display names, and user IDs. Automatically captures users from registrations.</li>
                    <li><strong>Converters:</strong> Simple utilities for converting between various encoding formats.</li>
                    <li><strong>Interceptor:</strong> Requires <a href="extension.zip">companion browser extension</a>. Intercepts all WebAuthn operations for modification (like <a href="https://portswigger.net/burp/documentation/desktop/tools/proxy/intercept-messages">Burp Suite</a> for WebAuthn). Includes built-in security and compliance tests.</li>
                    <li><strong>History:</strong> Tracks all interceptions and modifications, enabling value swaps across different passkey operations and browsers (i.e., victim and attacker browsers).</li>
                </ul>

                <h6>Usage Modes:</h6>
                <p>There are three different ways to use <span class="small-caps">Passkeys.Tools</span>:</p>
                <ul>
                    <li><strong>Standalone Testing:</strong> The simplest way to use these tools. Everything runs on this website and stays in your browser with no server-side components or browser extensions required. You can create keys that are stored securely in localStorage in your browser and not sent to anyone. Use these keys to manually create attestations, encode/decode existing ones, sign assertions, verify signatures, and test create/get API calls.</li>
                    <li><strong>Live Testing:</strong> Requires installation of the <a href="extension.zip">companion browser extension</a>, which overwrites the WebAuthn APIs in the browser to intercept all API calls and present them in the tool. This allows live capturing and modifications of ongoing WebAuthn operations. History is stored in localStorage - again, nothing is sent server-side. All operations happen locally in your browser.</li>
                    <li><strong>Cross-Browser Testing:</strong> Required when two browsers are used to simulate WebAuthn operations in victim and attacker browsers simultaneously. Since data needs to be shared across browsers, a backend component is required. In this case, keys, users, and history are stored server-side but protected with a unique key so only you can access the data. Do not use this server-side storage for real production passkeys or private accounts - only for testing. This setup enables scenarios like replacing the challenge in a passkey registration in the attacker browser with a challenge from the victim's browser to test if the challenge is correctly validated.</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="row mb-3">
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0">Client Capabilities</h5>
            </div>
            <div class="card-body">
                <div id="capabilities"></div>
            </div>
        </div>
    </div>
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0">Keyboard Shortcuts</h5>
            </div>
            <div class="card-body">
                <table class="table table-sm table-hover mb-0" id="shortcutsTable">
                    <thead>
                        <tr>
                            <th>Shortcut</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Dynamically populated -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
