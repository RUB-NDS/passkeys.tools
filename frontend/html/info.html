<div class="row mb-3">
    <div class="col m-3 p-3 text-center">
        <img src="logo.svg" width="200px">
        <h1 class="small-caps">Passkeys.Tools</h1>
        <h2>Encode, Decode, Intercept, Modify, and Exploit WebAuthn Operations</h2>
    </div>
</div>

<div class="row mb-3">
    <div class="col">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-info-circle me-2"></i>Overview</h5>
            </div>
            <div class="card-body">
                <p><span class="small-caps">Passkeys.Tools</span> is a comprehensive security testing and development toolkit for WebAuthn (passkey) implementations. It provides full emulation of both the client (browser) and authenticator layers, allowing security researchers, penetration testers, and developers to analyze relying party implementations for vulnerabilities and compliance issues.</p>
                <p class="mb-0"><strong>Key Capabilities:</strong> Decode and inspect WebAuthn attestations and assertions • Craft credentials with any algorithm • Intercept and modify WebAuthn API calls • Test challenge binding, signature verification, and origin validation • Simulate cross-session attacks between multiple browser profiles • Verify compliance with the <a href="https://www.w3.org/TR/webauthn-3/">WebAuthn specification</a>.</p>
            </div>
        </div>
    </div>
</div>

<div class="row mb-3">
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-sliders me-2"></i>Usage Modes</h5>
            </div>
            <div class="card-body">
                <h6><i class="bi bi-box me-2"></i>Standalone Mode</h6>
                <p class="text-muted small mb-2">Offline analysis and manual crafting of WebAuthn data</p>
                <p>A passive toolkit for decoding, modifying, and encoding WebAuthn attestations and assertions—think <a href="https://www.jwt.io">jwt.io</a> but for passkeys. All data (keys, users, history) is stored locally in your browser's localStorage.</p>
                <p><strong>Use when:</strong> You have captured WebAuthn data (e.g., from network logs) and need to analyze or modify it offline.</p>
                <p class="mb-3"><strong>Example:</strong> Decode an attestation object to inspect the credential public key, modify the signature counter, then re-encode it for replay testing.</p>

                <hr>

                <h6><i class="bi bi-lightning me-2"></i>Interceptor Mode</h6>
                <p class="text-muted small mb-2">Live interception and modification of WebAuthn API calls</p>
                <p>Builds on standalone mode by adding real-time interception via the <a href="extension.zip">browser extension</a>. The extension hooks into the WebAuthn API to capture and modify all <code>navigator.credentials.create()</code> and <code>get()</code> calls before they reach the relying party—similar to <a href="https://portswigger.net/burp">Burp Suite</a> but specialized for WebAuthn. Data remains in localStorage.</p>
                <p><strong>Use when:</strong> You need to test a relying party's server-side validation by modifying live WebAuthn responses.</p>
                <p class="mb-3"><strong>Example:</strong> Intercept a registration, replace the challenge with random bytes, and verify if the server properly validates challenge binding. Or flip a bit in the signature to test signature verification.</p>

                <hr>

                <h6><i class="bi bi-window-stack me-2"></i>Cross-Browser Mode</h6>
                <p class="text-muted small mb-2">Multi-browser testing with shared remote storage</p>
                <p>Extends interceptor mode with a remote storage backend, enabling two browser profiles (e.g., victim and attacker) to share keys, users, and history in real-time. This is essential for testing cross-session attacks where data must flow between separate browser instances. Optional end-to-end encryption protects your data on the server.</p>
                <p><strong>Use when:</strong> You need to simulate attacks involving multiple parties, such as session binding or credential reuse across different sessions.</p>
                <p><strong>Example:</strong> In browser A (victim), start a passkey registration and dismiss it. In browser B (attacker), intercept a registration and swap in the victim's challenge. If the server accepts this, it indicates a session binding vulnerability.</p>
            </div>
        </div>
    </div>
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-tools me-2"></i>Available Tools</h5>
            </div>
            <div class="card-body">
                <h6 class="mt-1"><i class="bi bi-box-arrow-in-down me-2"></i>Create</h6>
                <p class="mb-3">Trigger <code>navigator.credentials.create()</code> API calls with custom PublicKeyCredentialCreationOptions. Test how the browser and authenticator handle different registration parameters, algorithms, and attestation preferences.</p>

                <h6><i class="bi bi-box-arrow-up me-2"></i>Get</h6>
                <p class="mb-3">Trigger <code>navigator.credentials.get()</code> API calls with custom PublicKeyCredentialRequestOptions. Test authentication flows with specific credential IDs, user verification requirements, and mediation settings.</p>

                <h6><i class="bi bi-person-plus-fill me-2"></i>Attestation</h6>
                <p class="mb-3">Decode, inspect, modify, and re-encode attestation objects and clientDataJSON. Supports <code>none</code> and <code>packed</code> attestation formats. Manipulate flags, AAGUID, credential IDs, public keys, and extensions.</p>

                <h6><i class="bi bi-person-badge-fill me-2"></i>Assertion</h6>
                <p class="mb-3">Decode, modify, and encode assertion authenticatorData, clientDataJSON, and signatures. Sign assertions using stored private keys or verify existing signatures against stored public keys.</p>

                <h6><i class="bi bi-key me-2"></i>Keys</h6>
                <p class="mb-3">Manage cryptographic keys with full import/export support. Generate key pairs for all WebAuthn algorithms (ES256, ES384, ES512, RS256, PS256, EdDSA, etc.). Associate credential IDs with keys for realistic credential emulation.</p>

                <h6><i class="bi bi-people me-2"></i>Users</h6>
                <p class="mb-3">Store and manage user account data including RP IDs, usernames, display names, and user handles. Users are automatically captured during registration interceptions for easy reuse in authentication tests.</p>

                <h6><i class="bi bi-clock-history me-2"></i>History</h6>
                <p class="mb-3">Complete audit log of all intercepted operations. Search, filter, and export entries. Copy values between sessions to perform cross-operation attacks like challenge swapping or credential reuse.</p>

                <h6><i class="bi bi-arrow-left-right me-2"></i>Converters</h6>
                <p class="mb-3">Encoding utilities for Base64, Base64URL, and Hex conversions. Convert keys between JWK, COSE, PEM, and DER formats for compatibility with different tools and libraries.</p>

                <h6><i class="bi bi-lightning me-2"></i>Interceptor</h6>
                <p>Central hub for live WebAuthn interception (requires <a href="extension.zip">browser extension</a>). View request details, select credentials and keys, apply one-click security tests (challenge manipulation, signature tampering, flag modifications), and craft custom responses.</p>
            </div>
        </div>
    </div>
</div>

<div class="row mb-3">
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-cpu me-2"></i>Client Capabilities</h5>
            </div>
            <div class="card-body">
                <div id="capabilities"></div>
            </div>
        </div>
    </div>
    <div class="col-lg-6">
        <div class="card h-100">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-keyboard me-2"></i>Keyboard Shortcuts</h5>
            </div>
            <div class="card-body">
                <table class="table table-sm table-hover mb-0" id="shortcutsTable">
                    <thead>
                        <tr>
                            <th>Shortcut</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Dynamically populated -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="row mb-3">
    <div class="col">
        <div class="card">
            <div class="card-header">
                <h5 class="mb-0"><i class="bi bi-envelope me-2"></i>Contact</h5>
            </div>
            <div class="card-body">
                <p class="mb-0">TBD</p>
            </div>
        </div>
    </div>
</div>
